<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="pandas,data visualization," />










<meta name="description" content="基于pandas python的美团某商家的评论销售数据分析 爬虫获得美团某家烧烤店的订单（代码省略） 数据清洗 数据初步的统计 可视化 数据中的评论数据用于自然语言处理（待续）  导入相关库12345from pyecharts import Bar,Pieimport pandas as pdimport numpy as npimport  matplotlib.pyplot as  plt">
<meta name="keywords" content="pandas,data visualization">
<meta property="og:type" content="article">
<meta property="og:title" content="美团某商家的评论销售数据分析">
<meta property="og:url" content="http://yoursite.com/2018/08/11/美团某商家的评论销售数据分析/index.html">
<meta property="og:site_name" content="Friedman&#39;s blog">
<meta property="og:description" content="基于pandas python的美团某商家的评论销售数据分析 爬虫获得美团某家烧烤店的订单（代码省略） 数据清洗 数据初步的统计 可视化 数据中的评论数据用于自然语言处理（待续）  导入相关库12345from pyecharts import Bar,Pieimport pandas as pdimport numpy as npimport  matplotlib.pyplot as  plt">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu679dm0udj20q104zmxj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64b1fo14j21dk07kta0.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64qkqhgmj20ri0bf0t9.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64tdssydj20l70akjrq.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu69ce7yt9j20rs0b4dgn.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64ru2zugj20rt0bcjs1.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu657vuie0j20rr0de3z2.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66bowlaaj20km0aljrt.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66hxb8tmj20kb0arjrp.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66k2dzdgj20m80b4mxv.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bly1fu66xjsuk6j20m80b4wet.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66vpau0lj20m80b43yp.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66ujghx0j211i084wfj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66mxp9crj20p00b4gmb.jpg">
<meta property="og:updated_time" content="2018-08-11T17:50:37.261Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="美团某商家的评论销售数据分析">
<meta name="twitter:description" content="基于pandas python的美团某商家的评论销售数据分析 爬虫获得美团某家烧烤店的订单（代码省略） 数据清洗 数据初步的统计 可视化 数据中的评论数据用于自然语言处理（待续）  导入相关库12345from pyecharts import Bar,Pieimport pandas as pdimport numpy as npimport  matplotlib.pyplot as  plt">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu679dm0udj20q104zmxj.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/08/11/美团某商家的评论销售数据分析/"/>





  <title>美团某商家的评论销售数据分析 | Friedman's blog</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Friedman's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-resume">
          <a href="/resume" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            简历
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/11/美团某商家的评论销售数据分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Friedman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Friedman's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">美团某商家的评论销售数据分析</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-11T23:39:42+08:00">
                2018-08-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pandas/" itemprop="url" rel="index">
                    <span itemprop="name">pandas</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pandas/visualization/" itemprop="url" rel="index">
                    <span itemprop="name">visualization</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,763 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长&asymp;</span>
                
                <span title="阅读时长">
                  14 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="基于pandas-python的美团某商家的评论销售数据分析"><a href="#基于pandas-python的美团某商家的评论销售数据分析" class="headerlink" title="基于pandas python的美团某商家的评论销售数据分析"></a>基于pandas python的美团某商家的评论销售数据分析</h3><ul>
<li>爬虫获得美团某家烧烤店的订单（代码省略）</li>
<li>数据清洗</li>
<li>数据初步的统计</li>
<li>可视化</li>
<li>数据中的评论数据用于自然语言处理（待续）</li>
</ul>
<h4 id="导入相关库"><a href="#导入相关库" class="headerlink" title="导入相关库"></a>导入相关库</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> Bar,Pie</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span>  matplotlib.pyplot <span class="keyword">as</span>  plt</span><br><span class="line"><span class="keyword">import</span> time</span><br></pre></td></tr></table></figure>
<h4 id="数据清洗与简单统计"><a href="#数据清洗与简单统计" class="headerlink" title="数据清洗与简单统计"></a>数据清洗与简单统计</h4><ul>
<li>评论数据，其中包括一下几个字段</li>
<li>是否匿名，均价，评价（以去掉，后续会做一些关于这些评论的更为深入的分析），评价时间，交易截止时间，订单号，套餐，上传的图片链接，质量好坏，阅读量，回复量，评分，点赞数等。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_excel(<span class="string">"all_data_meituan.xlsx"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(<span class="string">'comment'</span>,axis=<span class="number">1</span>).head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu679dm0udj20q104zmxj.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'avgPrice'</span>].value_counts()</span><br><span class="line"><span class="comment"># 同一家店的均价应该为同一个数值，所以这列数据没多大的意义</span></span><br></pre></td></tr></table></figure>
<pre><code>73    17400
Name: avgPrice, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'anonymous'</span>].value_counts()</span><br><span class="line"><span class="comment"># 匿名评价与实名评价的比例大致在5:1左右</span></span><br></pre></td></tr></table></figure>
<pre><code>False    14402
True      2998
Name: anonymous, dtype: int64
</code></pre><a id="more"></a>
<h4 id="时间格式的转化"><a href="#时间格式的转化" class="headerlink" title="时间格式的转化"></a>时间格式的转化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convertTime</span><span class="params">(x)</span>:</span></span><br><span class="line">    y=time.localtime(x/<span class="number">1000</span>)</span><br><span class="line">    z=time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>,y)</span><br><span class="line">    <span class="keyword">return</span> z</span><br><span class="line">df[<span class="string">"commentTime"</span>]=df[<span class="string">"commentTime"</span>].apply(convertTime)</span><br><span class="line">df[<span class="string">"commentTime"</span>].head()</span><br></pre></td></tr></table></figure>
<pre><code>0    2018-05-09 22:21:48
1    2018-06-01 19:41:31
2    2018-04-04 11:52:23
3    2018-05-01 17:12:22
4    2018-05-17 16:48:04
Name: commentTime, dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在excel可以用筛选器直接看到这列中的数据含有缺失值，或者在拿到数据的时候，使用df.info() 查看每列的数据信息情况</span></span><br><span class="line">df[<span class="string">'dealEndtime'</span>].isna().value_counts()</span><br><span class="line"><span class="comment"># 这列数据中含有177个缺失值，其余完整</span></span><br></pre></td></tr></table></figure>
<pre><code>False    17223
True       177
Name: dealEndtime, dtype: int64
</code></pre><p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64b1fo14j21dk07kta0.jpg" alt=""></p>
<ul>
<li>按月统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'commentTime'</span>]=pd.to_datetime(df[<span class="string">'commentTime'</span>])</span><br><span class="line">df1 = df.set_index(<span class="string">'commentTime'</span>)</span><br><span class="line">df1.resample(<span class="string">'D'</span>).size().sort_values(ascending=<span class="keyword">False</span>).head(<span class="number">100</span>)</span><br><span class="line">df2=df1.resample(<span class="string">'M'</span>).size().to_period()</span><br><span class="line">df2=df2.reset_index()</span><br><span class="line"><span class="comment"># df2.columns</span></span><br><span class="line"><span class="comment"># from pyecharts import  Bar</span></span><br><span class="line">bar =Bar(<span class="string">"按月统计"</span>,width=<span class="number">1000</span>,height=<span class="number">800</span>)</span><br><span class="line">bar.add(<span class="string">"按月统计"</span>,df2[<span class="string">'commentTime'</span>],df2[<span class="number">0</span>],is_label_show=<span class="keyword">True</span>, is_datazoom_show=<span class="keyword">True</span>,is_toolbox_show=<span class="keyword">True</span>,is_more_utils=<span class="keyword">True</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64qkqhgmj20ri0bf0t9.jpg" alt=""></p>
<ul>
<li>按周统计<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'commentTime'</span>]=pd.to_datetime(df[<span class="string">'commentTime'</span>])</span><br><span class="line">df[<span class="string">'weekday'</span>] = df[<span class="string">'commentTime'</span>].dt.weekday</span><br><span class="line">df2= df.groupby([<span class="string">'weekday'</span>]).size()</span><br><span class="line"><span class="comment">#  周末吃外卖的还是教平时多了一些</span></span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span>  Bar</span><br><span class="line">bar =Bar(<span class="string">"按周统计"</span>,width=<span class="number">750</span>,height=<span class="number">400</span>)</span><br><span class="line">weekday=[<span class="string">"一"</span>,<span class="string">"二"</span>,<span class="string">"三"</span>,<span class="string">"四"</span>,<span class="string">"五"</span>,<span class="string">"六"</span>,<span class="string">"日"</span>]</span><br><span class="line">bar.add(<span class="string">"按周统计"</span>,[<span class="string">'周&#123;&#125;'</span>.format(i) <span class="keyword">for</span> i <span class="keyword">in</span> weekday],df2.values,is_label_show=<span class="keyword">True</span>, is_datazoom_show=<span class="keyword">False</span>,is_toolbox_show=<span class="keyword">True</span>,is_more_utils=<span class="keyword">True</span>,is_random=<span class="keyword">True</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64tdssydj20l70akjrq.jpg" alt=""></p>
<ul>
<li>按天统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'commentTime'</span>]=pd.to_datetime(df[<span class="string">'commentTime'</span>])</span><br><span class="line">df[<span class="string">'day'</span>] = df[<span class="string">'commentTime'</span>].dt.day</span><br><span class="line">df2= df.groupby([<span class="string">'day'</span>]).size()</span><br><span class="line">df2</span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span>  Bar</span><br><span class="line">bar =Bar(<span class="string">"按天统计"</span>,width=<span class="number">1000</span>,height=<span class="number">400</span>)</span><br><span class="line">bar.add(<span class="string">"按天统计"</span>,[<span class="string">'&#123;&#125; 日'</span>.format(i) <span class="keyword">for</span> i <span class="keyword">in</span> df2.index],df2.values,is_label_show=<span class="keyword">True</span>, is_datazoom_show=<span class="keyword">True</span>,is_toolbox_show=<span class="keyword">True</span>,is_more_utils=<span class="keyword">True</span>,is_random=<span class="keyword">True</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu69ce7yt9j20rs0b4dgn.jpg" alt=""></p>
<ul>
<li>按时统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'commentTime'</span>]=pd.to_datetime(df[<span class="string">'commentTime'</span>])</span><br><span class="line">df[<span class="string">'hour'</span>] = df[<span class="string">'commentTime'</span>].dt.hour</span><br><span class="line">df2= df.groupby([<span class="string">'hour'</span>]).size()</span><br><span class="line">df2</span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span>  Bar</span><br><span class="line">bar =Bar(<span class="string">"按时统计"</span>,width=<span class="number">1000</span>,height=<span class="number">600</span>)</span><br><span class="line">bar.add(<span class="string">"按时统计"</span>,[<span class="string">'&#123;&#125; h'</span>.format(i) <span class="keyword">for</span> i <span class="keyword">in</span> df2.index],df2.values,is_label_show=<span class="keyword">True</span>, is_datazoom_show=<span class="keyword">True</span>,is_toolbox_show=<span class="keyword">True</span>,is_more_utils=<span class="keyword">True</span>,is_random=<span class="keyword">True</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu64ru2zugj20rt0bcjs1.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 处理数据前需要先处理缺失值</span></span><br><span class="line"><span class="comment"># 订单结束时间清洗</span></span><br><span class="line">df[<span class="string">'dealEndtime'</span>].fillna(method=<span class="string">'ffill'</span>).apply(<span class="keyword">lambda</span> x:time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>,time.localtime(x))).head()</span><br></pre></td></tr></table></figure>
<pre><code>0    2018-06-30 14:00:00
1    2018-06-30 14:00:00
2    2018-06-30 14:00:00
3    2018-06-30 14:00:00
4    2018-06-30 14:00:00
Name: dealEndtime, dtype: object
</code></pre><h4 id="套餐的统计"><a href="#套餐的统计" class="headerlink" title="套餐的统计"></a>套餐的统计</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'menu'</span>].dropna().astype(<span class="string">'category'</span>).value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>2人午晚餐                       7640
单人午晚餐                       3920
学生专享午晚自助                    2638
4人午/晚自助                     1581
单人下午自助烤肉                     639
6人午/晚自助                      507
周一至周五自助烤肉/周六日及节假日自助烤肉2选1     209
单人午/晚自助                       67
周一至周五自助烤肉，免费WiFi              22
Name: menu, dtype: int64
</code></pre><p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu657vuie0j20rr0de3z2.jpg" alt=""></p>
<ul>
<li>阅读数与评分的协方差（相关性）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'readCnt'</span>].corr(df[<span class="string">'star'</span>])</span><br><span class="line"><span class="comment"># 评论阅读书与客户评价分数高低的相关性</span></span><br></pre></td></tr></table></figure>
<pre><code>0.05909293203205019
</code></pre><ul>
<li>最受欢迎的套餐(2人午晚餐评价分布)，基本上几种在30,40,50,评价都还好，怪不得卖得好</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_most=df[(df[<span class="string">"menu"</span>]==<span class="string">"2人午晚餐"</span>)][<span class="string">'star'</span>].value_counts().reindex(range(<span class="number">10</span>,<span class="number">60</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<pre><code>10     329
20     533
30    2002
40    2704
50    2072
Name: star, dtype: int64
</code></pre><p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66bowlaaj20km0aljrt.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"单人午晚餐"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>30    1215
40    1208
50    1093
20     298
10     106
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 学生专享午晚自助 </span></span><br><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"学生专享午晚自助"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>40    954
50    863
30    529
20    191
10    101
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"4人午/晚自助"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>50    536
30    432
40    414
10    131
20     68
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"单人下午自助烤肉"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>30    208
50    169
40    144
10     98
20     20
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"6人午/晚自助"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>50    245
40    142
30    112
10      8
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#周一至周五自助烤肉/周六日及节假日自助烤肉2选1</span></span><br><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"周一至周五自助烤肉/周六日及节假日自助烤肉2选1"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>50    87
40    66
30    46
20    10
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"单人午/晚自助"</span>)][<span class="string">'star'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>50    30
40    27
30    10
Name: star, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="string">"menu"</span>]==<span class="string">"周一至周五自助烤肉，免费WiFi"</span>)][<span class="string">'star'</span>].value_counts().reindex(range(<span class="number">10</span>,<span class="number">51</span>,<span class="number">10</span>)).fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>10     0.0
20     0.0
30     0.0
40     0.0
50    22.0
Name: star, dtype: float64
</code></pre><h4 id="套餐与评价汇总"><a href="#套餐与评价汇总" class="headerlink" title="套餐与评价汇总"></a>套餐与评价汇总</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># df.groupby(['menu','star']).size().to_excel("all_menu_star.xls") 可以直接导出到excel</span></span><br><span class="line">df.groupby([<span class="string">'menu'</span>,<span class="string">'star'</span>]).size()</span><br></pre></td></tr></table></figure>
<pre><code>menu                      star
2人午晚餐                     10       329
                          20       533
                          30      2002
                          40      2704
                          50      2072
4人午/晚自助                   10       131
                          20        68
                          30       432
                          40       414
                          50       536
6人午/晚自助                   10         8
                          30       112
                          40       142
                          50       245
单人下午自助烤肉                  10        98
                          20        20
                          30       208
                          40       144
                          50       169
单人午/晚自助                   30        10
                          40        27
                          50        30
单人午晚餐                     10       106
                          20       298
                          30      1215
                          40      1208
                          50      1093
周一至周五自助烤肉/周六日及节假日自助烤肉2选1  20        10
                          30        46
                          40        66
                          50        87
周一至周五自助烤肉，免费WiFi          50        22
学生专享午晚自助                  10       101
                          20       191
                          30       529
                          40       954
                          50       863
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'star'</span>,<span class="string">'menu'</span>,]).size()</span><br></pre></td></tr></table></figure>
<pre><code>star  menu                    
10    2人午晚餐                        329
      4人午/晚自助                      131
      6人午/晚自助                        8
      单人下午自助烤肉                      98
      单人午晚餐                        106
      学生专享午晚自助                     101
20    2人午晚餐                        533
      4人午/晚自助                       68
      单人下午自助烤肉                      20
      单人午晚餐                        298
      周一至周五自助烤肉/周六日及节假日自助烤肉2选1      10
      学生专享午晚自助                     191
30    2人午晚餐                       2002
      4人午/晚自助                      432
      6人午/晚自助                      112
      单人下午自助烤肉                     208
      单人午/晚自助                       10
      单人午晚餐                       1215
      周一至周五自助烤肉/周六日及节假日自助烤肉2选1      46
      学生专享午晚自助                     529
40    2人午晚餐                       2704
      4人午/晚自助                      414
      6人午/晚自助                      142
      单人下午自助烤肉                     144
      单人午/晚自助                       27
      单人午晚餐                       1208
      周一至周五自助烤肉/周六日及节假日自助烤肉2选1      66
      学生专享午晚自助                     954
50    2人午晚餐                       2072
      4人午/晚自助                      536
      6人午/晚自助                      245
      单人下午自助烤肉                     169
      单人午/晚自助                       30
      单人午晚餐                       1093
      周一至周五自助烤肉/周六日及节假日自助烤肉2选1      87
      周一至周五自助烤肉，免费WiFi              22
      学生专享午晚自助                     863
dtype: int64
</code></pre><ul>
<li>评分最高的套餐分布</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'star'</span>,<span class="string">'menu'</span>,]).size()[<span class="number">50</span>]</span><br></pre></td></tr></table></figure>
<pre><code>menu
2人午晚餐                       2072
4人午/晚自助                      536
6人午/晚自助                      245
单人下午自助烤肉                     169
单人午/晚自助                       30
单人午晚餐                       1093
周一至周五自助烤肉/周六日及节假日自助烤肉2选1      87
周一至周五自助烤肉，免费WiFi              22
学生专享午晚自助                     863
dtype: int64
</code></pre><p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66hxb8tmj20kb0arjrp.jpg" alt=""></p>
<ul>
<li>用户id统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># userId</span></span><br><span class="line"><span class="comment"># 这家店铺有好多回头客，万万没想到</span></span><br><span class="line">df[df[<span class="string">'userId'</span>]!=<span class="number">0</span>][<span class="string">'userId'</span>].value_counts().head(<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<pre><code>266045270     64
152775497     60
80372612      60
129840082     60
336387962     60
34216474      60
617772217     60
82682689      54
287219504     49
884729389     45
...
232697160     40
141718492     40
879430090     40
696143486     40
13257519      40
983797146     40
911947863     40
993057629     40
494215297     40
Name: userId, dtype: int64
</code></pre><ul>
<li>用户名统计,应该与用户id对应</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">'userName'</span>]!=<span class="string">"匿名用户"</span>][<span class="string">'userName'</span>].value_counts().head(<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<pre><code>xuruiss1026         64
黑发飘呀飘               60
么么哒我是你聪叔            60
jIx325233926        60
siisgood            60
vTF610712604        60
始于初见的你              60
yumengkou           54
Daaaav              49
梁子7543              45
oev575457132        40
oUI806055883        40
joF498901567        40
liE32679330         40
...
清晨cxh98             40
cBj31240225         40
天蛟Wing              40
榴莲馅月饼               40
leeman666888        40
迅行天下                40
滨海之恋33              40
pHO437742850        40
SzX539077433        40
Name: userName, dtype: int64
</code></pre><h4 id="评分与用户等级汇总"><a href="#评分与用户等级汇总" class="headerlink" title="评分与用户等级汇总"></a>评分与用户等级汇总</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'star'</span>,<span class="string">'userLevel'</span>,]).size()</span><br></pre></td></tr></table></figure>
<pre><code>star  userLevel
10    0             187
      1             139
      2             164
      3             193
      4              80
      5              10
20    0             223
      1              88
      2             304
      3             294
      4             207
      5              21
30    0            1147
      1             405
      2            1057
      3            1230
      4             570
      5             165
      6              20
40    0             870
      1             432
      2            1360
      3            1751
      4            1026
      5             261
      6              25
50    0             698
      1             386
      2            1167
      3            1670
      4             802
      5             318
      6             130
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">df_level_star = df.groupby([<span class="string">'userLevel'</span>,<span class="string">'star'</span>]).size()</span><br><span class="line">attr = np.arange(<span class="number">10</span>,<span class="number">60</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> Bar</span><br><span class="line">bar = Bar(<span class="string">"用户等级与评分"</span>,title_pos=<span class="string">"center"</span>)</span><br><span class="line">df_0 = df_level_star[<span class="number">0</span>].values</span><br><span class="line">df_1 = df_level_star[<span class="number">1</span>].values</span><br><span class="line">df_2 = df_level_star[<span class="number">2</span>].values</span><br><span class="line">df_3 = df_level_star[<span class="number">3</span>].values</span><br><span class="line">df_4 = df_level_star[<span class="number">4</span>].values</span><br><span class="line">df_5 = df_level_star[<span class="number">5</span>].values</span><br><span class="line"><span class="comment"># df_6 = df_level_star[6].values</span></span><br><span class="line">df_6 = df_level_star[<span class="number">6</span>].reindex(attr).fillna(<span class="number">0</span>).values</span><br><span class="line"></span><br><span class="line">bar.add(<span class="string">"level 0"</span>,attr,df_0,is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 1"</span>,attr,df_1,is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 2"</span>,attr,df_2,is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 3"</span>,attr,df_3,mark_line=[<span class="string">"average"</span>],mark_point=[<span class="string">'max'</span>,<span class="string">'min'</span>],is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 4"</span>,attr,df_4,is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 5"</span>,attr,df_5,is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 6"</span>,attr,df_6,is_label_show=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66k2dzdgj20m80b4mxv.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">bar = Bar(<span class="string">"用户等级与评分"</span>,title_pos=<span class="string">"center"</span>,title_color=<span class="string">"red"</span>)</span><br><span class="line">attr = np.arange(<span class="number">10</span>,<span class="number">60</span>,<span class="number">10</span>)</span><br><span class="line">df_0 = df_level_star[<span class="number">0</span>].values</span><br><span class="line">df_1 = df_level_star[<span class="number">1</span>].values</span><br><span class="line">df_2 = df_level_star[<span class="number">2</span>].values</span><br><span class="line">df_3 = df_level_star[<span class="number">3</span>].values</span><br><span class="line">df_4 = df_level_star[<span class="number">4</span>].values</span><br><span class="line">df_5 = df_level_star[<span class="number">5</span>].values</span><br><span class="line"><span class="comment"># df_6 = df_level_star[6].values</span></span><br><span class="line">df_6 = df_level_star[<span class="number">6</span>].reindex(attr).fillna(<span class="number">0</span>).values</span><br><span class="line">bar.add(<span class="string">"level 0"</span>,attr,df_0,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 1"</span>,attr,df_1,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 2"</span>,attr,df_2,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 3"</span>,attr,df_3,is_stack=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 4"</span>,attr,df_4,is_stack=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 5"</span>,attr,df_5,is_stack=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar.add(<span class="string">"level 6"</span>,attr,df_6,is_stack=<span class="keyword">True</span>,legend_pos=<span class="string">'right'</span>,legend_orient=<span class="string">'vertical'</span>,label_text_size=<span class="number">12</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bly1fu66xjsuk6j20m80b4wet.jpg" alt=""></p>
<ul>
<li><p>用户等级与评价的相关性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'star'</span>].corr(df[<span class="string">'userLevel'</span>])</span><br></pre></td></tr></table></figure>
<p>  0.14389808871897794</p>
</li>
</ul>
<ul>
<li>点赞分布</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df_zan=df[<span class="string">'zanCnt'</span>].value_counts()</span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> Bar</span><br><span class="line">bar=Bar(<span class="string">"点赞统计"</span>)</span><br><span class="line">bar.add(<span class="string">"点赞分布"</span>,df_zan.index[<span class="number">1</span>:],df_zan.values[<span class="number">1</span>:],is_label_show=<span class="keyword">True</span>)</span><br><span class="line">bar</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66vpau0lj20m80b43yp.jpg" alt=""></p>
<ul>
<li>数值型数据的统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66ujghx0j211i084wfj.jpg" alt=""></p>
<ul>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'userLevel'</span>].value_counts().reindex(range(<span class="number">7</span>))</span><br></pre></td></tr></table></figure>
<p>  0    3125<br>  1    1450<br>  2    4052<br>  3    5138<br>  4    2685<br>  5     775<br>  6     175<br>  Name: userLevel, dtype: int64</p>
</li>
<li><p>用户等级分布</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df_level=df[<span class="string">'userLevel'</span>].value_counts().reindex(range(<span class="number">7</span>))</span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> Pie</span><br><span class="line">pie=Pie(<span class="string">"用户等级分布"</span>,title_pos=<span class="string">"center"</span>,width=<span class="number">900</span>)</span><br><span class="line">pie.add(<span class="string">"levels distribution"</span>,[<span class="string">"level "</span>+str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>)],df_level.values,is_random=<span class="keyword">True</span>,radidus=[<span class="number">30</span>,<span class="number">45</span>],legend_pos=<span class="string">'left'</span>,rosetype=<span class="string">'area'</span>,legend_orient=<span class="string">'vertical'</span>,is_label_show=<span class="keyword">True</span>,label_text_size=<span class="number">20</span>)</span><br><span class="line">pie</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/9ebd4c2bgy1fu66mxp9crj20p00b4gmb.jpg" alt=""></p>
<ul>
<li>至此基本数据分析完成，后续会开始于其评论数据的挖掘</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pandas/" rel="tag"># pandas</a>
          
            <a href="/tags/data-visualization/" rel="tag"># data visualization</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/08/douban-top250-analysis/" rel="next" title="douban_top250_analysis">
                <i class="fa fa-chevron-left"></i> douban_top250_analysis
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Friedman</p>
              <p class="site-description motion-element" itemprop="description">如何执著</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#基于pandas-python的美团某商家的评论销售数据分析"><span class="nav-number">1.</span> <span class="nav-text">基于pandas python的美团某商家的评论销售数据分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#导入相关库"><span class="nav-number">1.1.</span> <span class="nav-text">导入相关库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据清洗与简单统计"><span class="nav-number">1.2.</span> <span class="nav-text">数据清洗与简单统计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#时间格式的转化"><span class="nav-number">1.3.</span> <span class="nav-text">时间格式的转化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#套餐的统计"><span class="nav-number">1.4.</span> <span class="nav-text">套餐的统计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#套餐与评价汇总"><span class="nav-number">1.5.</span> <span class="nav-text">套餐与评价汇总</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#评分与用户等级汇总"><span class="nav-number">1.6.</span> <span class="nav-text">评分与用户等级汇总</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Friedman</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





  

  

  

  
  

  

  

  

</body>
</html>
